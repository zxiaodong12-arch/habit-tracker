import{x as g,h as d,e as f,y as o}from"./index-BDX3lOMN.js";const A=g("habits",()=>{const r=d([]),c=d(!1),i=d(!0),l=f(()=>r.value.filter(a=>!a.archived)),u=f(()=>r.value.filter(a=>a.archived));async function n(){c.value=!0;try{const a=await o.getHabits(),t=new Map;for(const e of a){if(t.has(e.id)){console.warn("å‘çŽ°é‡å¤ä¹ æƒ¯ï¼Œè·³è¿‡:",e.id,e.name);continue}const s=await o.getRecords(e.id),h=o.convertHabitFromAPI(e,s);t.set(h.id,h)}r.value=Array.from(t.values())}catch(a){throw console.error("åŠ è½½ä¹ æƒ¯å¤±è´¥:",a),a}finally{c.value=!1}}async function v(a,t){try{await o.toggleRecord(a,t),await n()}catch(e){throw console.error("åˆ‡æ¢æ‰“å¡çŠ¶æ€å¤±è´¥:",e),e}}async function b(a,t,e){try{await o.createHabit({name:a.trim(),emoji:t||"ðŸ“",color:e||"#10b981",archived:!1}),await n()}catch(s){throw console.error("æ·»åŠ ä¹ æƒ¯å¤±è´¥:",s),s}}async function w(a,t){try{await o.updateHabit(a,t),await n()}catch(e){throw console.error("æ›´æ–°ä¹ æƒ¯å¤±è´¥:",e),e}}async function H(a){try{await o.deleteHabit(a),r.value=r.value.filter(t=>t.id!==a)}catch(t){throw console.error("åˆ é™¤ä¹ æƒ¯å¤±è´¥:",t),t}}async function y(a){try{const t=r.value.find(e=>e.id===a);t&&(await o.archiveHabit(a,!t.archived),await n())}catch(t){throw console.error("å½’æ¡£/å–æ¶ˆå½’æ¡£å¤±è´¥:",t),t}}function p(){i.value=!i.value}return{habits:r,loading:c,archivedCollapsed:i,activeHabits:l,archivedHabits:u,loadHabits:n,toggleHabit:v,addHabit:b,updateHabit:w,deleteHabit:H,toggleArchiveHabit:y,toggleArchivedCollapsed:p}}),_=(r,c)=>{const i=r.__vccOpts||r;for(const[l,u]of c)i[l]=u;return i};export{_,A as u};
